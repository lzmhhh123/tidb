[
  {
    "Name": "TestIndexJoinHavingExprInInnerJoinKeys",
    "Cases": [
      {
        "SQL": "select /*+ inl_join(t1, t2) */ * from t1 join t2 on t1.v_float = t2.v_int",
        "Explain": [
          "Projection_6 12500.00 root Column#1, Column#2, Column#3, Column#5, Column#6, Column#7",
          "└─IndexJoin_11 12500.00 root inner join, inner:Projection_10, outer key:Column#2, inner key:Column#5",
          "  ├─TableReader_22 10000.00 root data:TableScan_21",
          "  │ └─TableScan_21 10000.00 cop[tikv] table:t1, range:[-inf,+inf], keep order:false, stats:pseudo",
          "  └─Projection_10 1.25 root Column#5, Column#6, Column#7, cast(Column#5)",
          "    └─IndexLookUp_9 1.25 root ",
          "      ├─IndexScan_7 1.25 cop[tikv] table:t2, index:v_int, range: decided by [eq(Column#5, Column#2)], keep order:false, stats:pseudo",
          "      └─TableScan_8 1.25 cop[tikv] table:t2, keep order:false, stats:pseudo"
        ],
        "Res": [
          "1 1 1.0000000000 1 1 1.0000000000",
          "2 2 2.0000000000 2 2 2.0000000000"
        ]
      },
      {
        "SQL": "select /*+ hash_join(t1, t2) */ * from t1 join t2 on t1.v_float = t2.v_int",
        "Explain": [
          "Projection_6 12500.00 root Column#1, Column#2, Column#3, Column#5, Column#6, Column#7",
          "└─HashLeftJoin_21 12500.00 root inner join, inner:Projection_25, equal:[eq(Column#2, Column#9)]",
          "  ├─TableReader_24 10000.00 root data:TableScan_23",
          "  │ └─TableScan_23 10000.00 cop[tikv] table:t1, range:[-inf,+inf], keep order:false, stats:pseudo",
          "  └─Projection_25 10000.00 root Column#5, Column#6, Column#7, cast(Column#5)",
          "    └─TableReader_27 10000.00 root data:TableScan_26",
          "      └─TableScan_26 10000.00 cop[tikv] table:t2, range:[-inf,+inf], keep order:false, stats:pseudo"
        ],
        "Res": [
          "1 1 1.0000000000 1 1 1.0000000000",
          "2 2 2.0000000000 2 2 2.0000000000"
        ]
      },
      {
        "SQL": "select /*+ inl_join(t1, t2) */ * from t1 join t2 on t1.v_decimal = t2.v_int",
        "Explain": [
          "Projection_6 12500.00 root Column#1, Column#2, Column#3, Column#5, Column#6, Column#7",
          "└─IndexJoin_11 12500.00 root inner join, inner:Projection_10, outer key:Column#3, inner key:Column#5",
          "  ├─TableReader_22 10000.00 root data:TableScan_21",
          "  │ └─TableScan_21 10000.00 cop[tikv] table:t1, range:[-inf,+inf], keep order:false, stats:pseudo",
          "  └─Projection_10 1.25 root Column#5, Column#6, Column#7, cast(Column#5)",
          "    └─IndexLookUp_9 1.25 root ",
          "      ├─IndexScan_7 1.25 cop[tikv] table:t2, index:v_int, range: decided by [eq(Column#5, Column#3)], keep order:false, stats:pseudo",
          "      └─TableScan_8 1.25 cop[tikv] table:t2, keep order:false, stats:pseudo"
        ],
        "Res": [
          "1 1 1.0000000000 1 1 1.0000000000",
          "2 2 2.0000000000 2 2 2.0000000000"
        ]
      },
      {
        "SQL": "select /*+ hash_join(t1, t2) */ * from t1 join t2 on t1.v_decimal = t2.v_int",
        "Explain": [
          "Projection_6 12500.00 root Column#1, Column#2, Column#3, Column#5, Column#6, Column#7",
          "└─HashLeftJoin_21 12500.00 root inner join, inner:Projection_25, equal:[eq(Column#3, Column#9)]",
          "  ├─TableReader_24 10000.00 root data:TableScan_23",
          "  │ └─TableScan_23 10000.00 cop[tikv] table:t1, range:[-inf,+inf], keep order:false, stats:pseudo",
          "  └─Projection_25 10000.00 root Column#5, Column#6, Column#7, cast(Column#5)",
          "    └─TableReader_27 10000.00 root data:TableScan_26",
          "      └─TableScan_26 10000.00 cop[tikv] table:t2, range:[-inf,+inf], keep order:false, stats:pseudo"
        ],
        "Res": [
          "1 1 1.0000000000 1 1 1.0000000000",
          "2 2 2.0000000000 2 2 2.0000000000"
        ]
      }
    ]
  }
]
