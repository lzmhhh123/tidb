[
  {
    "Name": "TestIndexJoinHavingExprInInnerJoinKeys",
    "Cases": [
      {
        "SQL": "select /*+ inl_join(t1, t2) */ * from t1 join t2 on t1.v_float = t2.v_int",
        "Explain": [
          "Projection_6 12500.00 root Column#1, Column#2, Column#3, Column#4, Column#5, Column#6, Column#8, Column#9, Column#10, Column#11, Column#12, Column#13",
          "└─IndexJoin_11 12500.00 root inner join, inner:Projection_10, outer key:Column#2, inner key:Column#8",
          "  ├─TableReader_22 10000.00 root data:TableScan_21",
          "  │ └─TableScan_21 10000.00 cop[tikv] table:t1, range:[-inf,+inf], keep order:false, stats:pseudo",
          "  └─Projection_10 1.25 root Column#8, Column#9, Column#10, Column#11, Column#12, Column#13, cast(Column#8)",
          "    └─IndexLookUp_9 1.25 root ",
          "      ├─IndexScan_7 1.25 cop[tikv] table:t2, index:v_int, range: decided by [eq(Column#8, Column#2)], keep order:false, stats:pseudo",
          "      └─TableScan_8 1.25 cop[tikv] table:t2, keep order:false, stats:pseudo"
        ],
        "Res": [
          "1 1 1.00 1.0000000000 2019-11-25 00:00:01 00:00:01 1 1 1.00 1.0000000000 2019-11-25 00:00:01 00:00:01",
          "2 2 2 2.0000000000 2019-11-25 00:00:02 00:00:02 2 2 2 2.0000000000 2019-11-25 00:00:02 00:00:02"
        ]
      },
      {
        "SQL": "select /*+ inl_join(t1, t2) */ * from t1 join t2 on t1.v_decimal = t2.v_int",
        "Explain": [
          "Projection_6 12500.00 root Column#1, Column#2, Column#3, Column#4, Column#5, Column#6, Column#8, Column#9, Column#10, Column#11, Column#12, Column#13",
          "└─IndexJoin_11 12500.00 root inner join, inner:Projection_10, outer key:Column#4, inner key:Column#8",
          "  ├─TableReader_22 10000.00 root data:TableScan_21",
          "  │ └─TableScan_21 10000.00 cop[tikv] table:t1, range:[-inf,+inf], keep order:false, stats:pseudo",
          "  └─Projection_10 1.25 root Column#8, Column#9, Column#10, Column#11, Column#12, Column#13, cast(Column#8)",
          "    └─IndexLookUp_9 1.25 root ",
          "      ├─IndexScan_7 1.25 cop[tikv] table:t2, index:v_int, range: decided by [eq(Column#8, Column#4)], keep order:false, stats:pseudo",
          "      └─TableScan_8 1.25 cop[tikv] table:t2, keep order:false, stats:pseudo"
        ],
        "Res": [
          "1 1 1.00 1.0000000000 2019-11-25 00:00:01 00:00:01 1 1 1.00 1.0000000000 2019-11-25 00:00:01 00:00:01",
          "2 2 2 2.0000000000 2019-11-25 00:00:02 00:00:02 2 2 2 2.0000000000 2019-11-25 00:00:02 00:00:02"
        ]
      },
      {
        "SQL": "select /*+ inl_join(t1, t2) */ * from t1 join t2 on t1.v_string = t2.v_int",
        "Explain": [
          "Projection_7 12500.00 root Column#1, Column#2, Column#3, Column#4, Column#5, Column#6, Column#8, Column#9, Column#10, Column#11, Column#12, Column#13",
          "└─IndexJoin_12 12500.00 root inner join, inner:Projection_11, outer key:Column#15, inner key:Column#8",
          "  ├─Projection_22 10000.00 root Column#1, Column#2, Column#3, Column#4, Column#5, Column#6, cast(Column#3)",
          "  │ └─TableReader_24 10000.00 root data:TableScan_23",
          "  │   └─TableScan_23 10000.00 cop[tikv] table:t1, range:[-inf,+inf], keep order:false, stats:pseudo",
          "  └─Projection_11 1.25 root Column#8, Column#9, Column#10, Column#11, Column#12, Column#13, cast(Column#8)",
          "    └─IndexLookUp_10 1.25 root ",
          "      ├─IndexScan_8 1.25 cop[tikv] table:t2, index:v_int, range: decided by [eq(Column#8, Column#15)], keep order:false, stats:pseudo",
          "      └─TableScan_9 1.25 cop[tikv] table:t2, keep order:false, stats:pseudo"
        ],
        "Res": [
          "1 1 1.00 1.0000000000 2019-11-25 00:00:01 00:00:01 1 1 1.00 1.0000000000 2019-11-25 00:00:01 00:00:01",
          "2 2 2 2.0000000000 2019-11-25 00:00:02 00:00:02 2 2 2 2.0000000000 2019-11-25 00:00:02 00:00:02"
        ]
      },
      {
        "SQL": "select /*+ inl_join(t1, t2) */ * from t1 join t2 on t1.v_datetime = t2.v_int",
        "Explain": [
          "Projection_7 12500.00 root Column#1, Column#2, Column#3, Column#4, Column#5, Column#6, Column#8, Column#9, Column#10, Column#11, Column#12, Column#13",
          "└─IndexJoin_12 12500.00 root inner join, inner:Projection_11, outer key:Column#15, inner key:Column#8",
          "  ├─Projection_22 10000.00 root Column#1, Column#2, Column#3, Column#4, Column#5, Column#6, cast(Column#5)",
          "  │ └─TableReader_24 10000.00 root data:TableScan_23",
          "  │   └─TableScan_23 10000.00 cop[tikv] table:t1, range:[-inf,+inf], keep order:false, stats:pseudo",
          "  └─Projection_11 1.25 root Column#8, Column#9, Column#10, Column#11, Column#12, Column#13, cast(Column#8)",
          "    └─IndexLookUp_10 1.25 root ",
          "      ├─IndexScan_8 1.25 cop[tikv] table:t2, index:v_int, range: decided by [eq(Column#8, Column#15)], keep order:false, stats:pseudo",
          "      └─TableScan_9 1.25 cop[tikv] table:t2, keep order:false, stats:pseudo"
        ],
        "Res": null
      },
      {
        "SQL": "select /*+ inl_join(t1, t2) */ * from t1 join t2 on t1.v_time = t2.v_int",
        "Explain": [
          "Projection_7 12500.00 root Column#1, Column#2, Column#3, Column#4, Column#5, Column#6, Column#8, Column#9, Column#10, Column#11, Column#12, Column#13",
          "└─IndexJoin_12 12500.00 root inner join, inner:Projection_11, outer key:Column#15, inner key:Column#8",
          "  ├─Projection_22 10000.00 root Column#1, Column#2, Column#3, Column#4, Column#5, Column#6, cast(Column#6)",
          "  │ └─TableReader_24 10000.00 root data:TableScan_23",
          "  │   └─TableScan_23 10000.00 cop[tikv] table:t1, range:[-inf,+inf], keep order:false, stats:pseudo",
          "  └─Projection_11 1.25 root Column#8, Column#9, Column#10, Column#11, Column#12, Column#13, cast(Column#8)",
          "    └─IndexLookUp_10 1.25 root ",
          "      ├─IndexScan_8 1.25 cop[tikv] table:t2, index:v_int, range: decided by [eq(Column#8, Column#15)], keep order:false, stats:pseudo",
          "      └─TableScan_9 1.25 cop[tikv] table:t2, keep order:false, stats:pseudo"
        ],
        "Res": [
          "1 1 1.00 1.0000000000 2019-11-25 00:00:01 00:00:01 1 1 1.00 1.0000000000 2019-11-25 00:00:01 00:00:01",
          "2 2 2 2.0000000000 2019-11-25 00:00:02 00:00:02 2 2 2 2.0000000000 2019-11-25 00:00:02 00:00:02"
        ]
      }
    ]
  }
]
